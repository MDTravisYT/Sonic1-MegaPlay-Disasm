VBLANK:
		MOVEM.L	D0-D7/A0-A6,	-(SP)
		JSR		(SUB_68A).L
		TST.B	(V_VBLA_ROUTINE).W
		BEQ.S	VBLA_00
		MOVE.L	#$40000010,	($C00004).L
		MOVE.L	(V_SCRPOSY_VDP).W,	($C00000).L
		BTST	#6,	(V_MEGADRIVE).W
		BEQ.S	VB_NOTPAL
		MOVE.W	#$700,	D0
		
	VB_WAITPAL:
		DBF		D0,	VB_WAITPAL
		
	VB_NOTPAL:
		MOVE.B	(V_VBLA_ROUTINE).W,	D0
		MOVE.B	#0,	(V_VBLA_ROUTINE).W
		MOVE.W	#1,	(F_HBLA_PAL).W
		ANDI.W	#$3E,	D0
		MOVE.W	VBLA_INDEX(PC,D0.W),	D0
		JSR		VBLA_INDEX(PC,D0.W)
		
	VBLA_MUSIC:
		JSR		UPDATEMUSIC
		
	VBLA_EXIT:
		ADDQ.L	#1,	(V_VBLA_COUNT).W
		BSR.W	SUB_81E
		MOVEM.L	(SP)+,	D0-D7/A0-A6
		RTE

VBLA_INDEX:
		DC.W	VBLA_00-VBLA_INDEX
		DC.W	VBLA_02-VBLA_INDEX
		DC.W	VBLA_04-VBLA_INDEX
		DC.W	VBLA_06-VBLA_INDEX
		DC.W	VBLA_08-VBLA_INDEX
		DC.W	VBLA_0A-VBLA_INDEX
		DC.W	VBLA_0C-VBLA_INDEX
		DC.W	VBLA_0E-VBLA_INDEX
		DC.W	VBLA_08-VBLA_INDEX
		DC.W	VBLA_10-VBLA_INDEX
		DC.W	VBLA_14-VBLA_INDEX
		DC.W	VBLA_12-VBLA_INDEX
		DC.W	VBLA_0C-VBLA_INDEX
		DC.W	VBLA_16-VBLA_INDEX
		
VBLA_00:	
		CMPI.B	#$8C,	(V_GAMEMODE).W
		BEQ.S	VB00_ISLEVEL
		CMPI.B	#$C,	(V_GAMEMODE).W
		BNE.W	VBLA_MUSIC
		
	VB00_ISLEVEL:
		CMPI.B	#1,	(V_ZONE).W
		BNE.W	VBLA_MUSIC
		MOVE.W	($C00004).L,	D0
		BTST	#6,	(V_MEGADRIVE).W
		BEQ.S	VB00_NOTPAL
		MOVE.W	#$700,	D0
		
	VB00_WAITPAL:
		DBF	D0,	VB00_WAITPAL
		
	VB00_NOTPAL:
		MOVE.W	#1,	(F_HBLA_PAL).W
		TST.B	(F_WTR_STATE).W
		BNE.S	VB00_WATERABOVE
		LEA		($C00004).L,	A5
		MOVE.L	#$94009340,	(A5)
		MOVE.L	#$96FD9580,	(A5)
		MOVE.W	#$977F,	(A5)
		MOVE.W	#$C000,	(A5)
		MOVE.W	#$80,	(V_VDP_BUFFER2).W
		MOVE.W	(V_VDP_BUFFER2).W,	(A5)
		BRA.S	VB00_WATERBELOW
		
	VB00_WATERABOVE:
		LEA		($C00004).L,	A5
		MOVE.L	#$94009340,	(A5)
		MOVE.L	#$96FD9540,	(A5)
		MOVE.W	#$977F,	(A5)
		MOVE.W	#$C000,	(A5)
		MOVE.W	#$80,	(V_VDP_BUFFER2).W
		MOVE.W	(V_VDP_BUFFER2).W,	(A5)
		
	VB00_WATERBELOW:
		MOVE.W	(V_HBLA_HREG).W,	(A5)
		BRA.W	VBLA_MUSIC
		
	
VBLA_02:	
		BSR.W	SUB_12A8
		
VBLA_14:	
		TST.W	(V_DEMOLENGTH).W
		BEQ.W	VB02_END
		SUBQ.W	#1,	(V_DEMOLENGTH).W

	VB02_END:
		RTS

VBLA_04:	
		BSR.W	SUB_12A8
		BSR.W	LOADTILESASYOUMOVE_BGONLY
		BSR.W	SUB_1862
		TST.W	(V_DEMOLENGTH).W
		BEQ.W	VB04_END
		SUBQ.W	#1,	(V_DEMOLENGTH).W
		
	VB04_END:
		RTS

VBLA_06:	
		BSR.W	SUB_12A8
		RTS

VBLA_08:	DC.B	'VBLANK ROUTINE 8'
		ALIGN	$102E
VBLA_0A:	DC.B	'VBLANK ROUTINE A'
		ALIGN	$10E0
VBLA_0C:	DC.B	'VBLANK ROUTINE C'
		ALIGN	$11DE
VBLA_0E:	DC.B	'VBLANK ROUTINE E'
		ALIGN	$11EE
VBLA_10:	DC.B	'VBLANK 10'
		ALIGN	$11FA
VBLA_12:	DC.B	'VBLANK ROUTINE 12'
		ALIGN	$12A8
	SUB_12A8:
		ALIGN	$1346
VBLA_16:	DC.B	'VBLANK ROUTINE 16'