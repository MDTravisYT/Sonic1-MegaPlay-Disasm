PALETTEWHITEOUT:
		MOVE.W	#$3F,	(V_PFADE_START).W
		MOVE.W	#$15,	D4
		
	PWO_LOOP:
		MOVE.B	#$12,	(V_VBLA_ROUTINE).W
		BSR.W	WAITFORVBLA
		BSR.S	WHITEOUT_TOWHITE
		BSR.W	RUNPLC
		DBF		D4,	PWO_LOOP
		RTS
		
WHITEOUT_TOWHITE:
		MOVEQ	#0,	D0
		LEA	(V_PAL_DRY).W,	A0
		MOVE.B	(V_PFADE_START).W,	D0
		ADDA.W	D0,	A0
		MOVE.B	(V_PFADE_START+1).W,	D0
		
	WOTW_ADDCOLOR:
		BSR.S	WHITEOUT_ADDCOLOR
		DBF		D0,	WOTW_ADDCOLOR
		MOVEQ	#0,	D0
		LEA		(V_PAL_WATER).W,	A0
		MOVE.B	(V_PFADE_START).W,	D0
		ADDA.W	D0,	A0
		MOVE.B	(V_PFADE_START+1).W,	D0
		
	WOTW_ADDCOLOR2:
		BSR.S	WHITEOUT_ADDCOLOR
		DBF		D0,	WOTW_ADDCOLOR2
		RTS
		
WHITEOUT_ADDCOLOR:
	WOAC_ADDRED:
		MOVE.W	(A0),	D2
		CMPI.W	#$EEE,	D2
		BEQ.S	WOAC_NEXT
		MOVE.W	D2,	D1
		ANDI.W	#$E,	D1
		CMPI.W	#$E,	D1
		BEQ.S	WOAC_ADDGREEN
		ADDQ.W	#2,	(A0)+
		RTS
		
	WOAC_ADDGREEN:
		MOVE.W	D2,	D1
		ANDI.W	#$E0,	D1
		CMPI.W	#$E0,	D1
		BEQ.S	WOAC_ADDBLUE
		ADDI.W	#$20,	(A0)+
		RTS
		
	WOAC_ADDBLUE:
		MOVE.W	D2,	D1
		ANDI.W	#$E00,	D1
		CMPI.W	#$E00,	D1
		BEQ.S	WOAC_NEXT
		ADDI.W	#$200,	(A0)+
		RTS
		
	WOAC_NEXT:
		ADDQ.W	#2,	A0
		RTS